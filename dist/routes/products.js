"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.router = void 0;
const express_1 = require("express");
const products_1 = require("../services/products");
const fileHandler_1 = require("../utils/fileHandler");
const express_validator_1 = require("express-validator");
const createProduct_1 = require("../validationSchema/product/createProduct");
const validateAllParams_1 = require("../middlewares/validateAllParams");
const parseBody_1 = require("../utils/parseBody");
const updateProduct_1 = require("../validationSchema/product/updateProduct");
const updateStateProduct_1 = require("../validationSchema/product/updateStateProduct");
const validateToken_1 = require("../middlewares/validateToken");
const role_1 = require("../enums/role");
const validateRole_1 = require("../middlewares/validateRole");
const product_controller_1 = require("../controllers/product.controller");
const getProduct_1 = require("../validationSchema/product/getProduct");
const router = (0, express_1.Router)();
exports.router = router;
const service = new products_1.ProductService();
const controller = new product_controller_1.ProductController(service);
router.get("/", validateToken_1.validateToken, (0, validateRole_1.hasRole)([role_1.Roles.Operador, role_1.Roles.Usuario]), (0, express_validator_1.checkSchema)(getProduct_1.GET_PRODUCT_SCHEMA), validateAllParams_1.validateAllParams, controller.getAllActiveProducts.bind(controller));
router.get("/allProducts", validateToken_1.validateToken, (0, validateRole_1.hasRole)([role_1.Roles.Operador]), (0, express_validator_1.checkSchema)(getProduct_1.GET_PRODUCT_SCHEMA), validateAllParams_1.validateAllParams, controller.getAllProductsActiveInactive.bind(controller));
router.post("/", validateToken_1.validateToken, (0, validateRole_1.hasRole)([role_1.Roles.Operador]), fileHandler_1.upload.single("image"), parseBody_1.parseBodyToJson, (0, express_validator_1.checkSchema)(createProduct_1.CREATE_PRODUCT_SCHEMA), [validateAllParams_1.validateAllParams], controller.createProduct.bind(controller));
router.put("/changestate/:id", validateToken_1.validateToken, (0, validateRole_1.hasRole)([role_1.Roles.Operador]), (0, express_validator_1.checkSchema)(updateStateProduct_1.UPDATE_STATE_PRODUCT_SCHEMA), validateAllParams_1.validateAllParams, controller.changeProductState.bind(controller));
router.put("/:id", validateToken_1.validateToken, (0, validateRole_1.hasRole)([role_1.Roles.Operador]), fileHandler_1.upload.single("image"), parseBody_1.parseBodyToJson, (0, express_validator_1.checkSchema)(updateProduct_1.UPDATE_PRODUCT_SCHEMA), validateAllParams_1.validateAllParams, controller.updateProduct.bind(controller));
//# sourceMappingURL=products.js.map